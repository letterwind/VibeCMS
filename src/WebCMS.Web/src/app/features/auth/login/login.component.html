<div
  class="container-fluid vh-100 d-flex align-items-center justify-content-center bg-light"
>
  <div class="card shadow" style="width: 400px">
    <div class="card-body p-4">
      <h4 class="card-title text-center mb-4">
        {{ "login.title" | translate }}
      </h4>

      @if (errorMessage()) {
        <div class="alert alert-danger" role="alert">
          {{ errorMessage() }}
        </div>
      }

      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
        <div class="mb-3">
          <label for="account" class="form-label"
            >{{ "login.account" | translate }}
            <span class="text-danger">*</span></label
          >
          <input
            type="text"
            class="form-control"
            id="account"
            formControlName="account"
            placeholder="{{ 'login.accountPlaceholder' | translate }}"
            [class.is-invalid]="isFieldInvalid('account')"
          />
          <app-validation-error
            [control]="loginForm.get('account')"
            [fieldName]="'login.account' | translate"
          >
          </app-validation-error>
        </div>

        <div class="mb-3">
          <label for="password" class="form-label"
            >{{ "login.password" | translate }}
            <span class="text-danger">*</span></label
          >
          <input
            type="password"
            class="form-control"
            id="password"
            formControlName="password"
            placeholder="{{ 'login.passwordPlaceholder' | translate }}"
            [class.is-invalid]="isFieldInvalid('password')"
          />
          <app-validation-error
            [control]="loginForm.get('password')"
            [fieldName]="'login.password' | translate"
          >
          </app-validation-error>
        </div>

        <div class="mb-3">
          <label for="captcha" class="form-label"
            >{{ "login.captcha" | translate }}
            <span class="text-danger">*</span></label
          >
          <div class="input-group">
            <input
              type="text"
              class="form-control"
              id="captcha"
              formControlName="captcha"
              placeholder="{{ 'login.captchaPlaceholder' | translate }}"
              [class.is-invalid]="isFieldInvalid('captcha')"
            />
            <span
              class="input-group-text p-0"
              style="cursor: pointer"
              (click)="refreshCaptcha()"
              [title]="'login.refreshCaptcha' | translate"
            >
              @if (captchaImage()) {
                <img
                  [src]="'data:image/png;base64,' + captchaImage()"
                  [alt]="'login.captcha' | translate"
                  style="height: 38px"
                />
              } @else {
                <span class="px-3">{{ "common.loading" | translate }}</span>
              }
            </span>
          </div>
          <app-validation-error
            [control]="loginForm.get('captcha')"
            [fieldName]="'login.captcha' | translate"
          >
          </app-validation-error>
        </div>

        <button
          type="submit"
          class="btn btn-primary w-100"
          [disabled]="isLoading()"
        >
          @if (isLoading()) {
            <span
              class="spinner-border spinner-border-sm me-2"
              role="status"
            ></span>
          }
          {{ "login.submit" | translate }}
        </button>
      </form>
    </div>
  </div>
</div>
