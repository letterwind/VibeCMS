<form [formGroup]="form" (ngSubmit)="onSubmit()">
  <!-- Basic Info Section -->
  <div class="mb-4">
    <h6 class="text-muted mb-3">
      <i class="bi bi-info-circle me-1"></i>{{ "common.basicInfo" | translate }}
    </h6>

    <div class="mb-3">
      <label for="name" class="form-label"
        >{{ "category.name" | translate }}
        <span class="text-danger">*</span></label
      >
      <input
        type="text"
        class="form-control"
        id="name"
        formControlName="name"
        maxlength="20"
        [class.is-invalid]="isFieldInvalid('name')"
      />
      <div class="form-text">
        {{ "validation.maxCharacters" | translate: [20] }} ({{
          form.get("name")?.value?.length || 0
        }}/20)
      </div>
      <app-validation-error
        [control]="form.get('name')"
        [fieldName]="'category.name' | translate"
      >
      </app-validation-error>
    </div>

    <div class="mb-3">
      <label for="slug" class="form-label"
        >{{ "common.slug" | translate }}
        <span class="text-danger">*</span></label
      >
      <div class="input-group">
        <span class="input-group-text">/category/</span>
        <input
          type="text"
          class="form-control"
          id="slug"
          formControlName="slug"
          maxlength="100"
          [class.is-invalid]="isFieldInvalid('slug')"
          (input)="onSlugInput($event)"
        />
      </div>
      <div class="form-text">{{ "category.slugHint" | translate }}</div>
      <app-validation-error
        [control]="form.get('slug')"
        [fieldName]="'common.slug' | translate"
        [customMessages]="{
          pattern: languageService.getTranslation('category.slugPattern'),
        }"
      >
      </app-validation-error>
    </div>

    <div class="mb-3">
      <label for="parentId" class="form-label">{{
        "category.parentCategory" | translate
      }}</label>
      <select
        class="form-select"
        id="parentId"
        formControlName="parentId"
        [class.is-invalid]="isFieldInvalid('parentId')"
      >
        <option [ngValue]="null">{{ "category.noParent" | translate }}</option>
        @for (cat of availableParents; track cat.id) {
          <option [ngValue]="cat.id">{{ cat.indent }}{{ cat.name }}</option>
        }
      </select>
      <div class="form-text">{{ "category.maxLevelHint" | translate }}</div>
    </div>

    <div class="mb-3">
      <label for="sortOrder" class="form-label">{{
        "category.sortOrder" | translate
      }}</label>
      <input
        type="number"
        class="form-control"
        id="sortOrder"
        formControlName="sortOrder"
        min="0"
      />
      <div class="form-text">{{ "category.sortOrderHint" | translate }}</div>
    </div>
  </div>

  <!-- SEO Section -->
  <div class="mb-4">
    <h6 class="text-muted mb-3">
      <i class="bi bi-search me-1"></i>{{ "common.seoSetting" | translate }}
    </h6>

    <div class="mb-3">
      <label for="metaTitle" class="form-label">{{
        "common.seoTitle" | translate
      }}</label>
      <input
        type="text"
        class="form-control"
        id="metaTitle"
        formControlName="metaTitle"
        maxlength="100"
        [class.is-invalid]="isFieldInvalid('metaTitle')"
      />
      <div class="form-text">{{ "category.metaTitleHint" | translate }}</div>
      <app-validation-error
        [control]="form.get('metaTitle')"
        [fieldName]="'common.seoTitle' | translate"
      >
      </app-validation-error>
    </div>

    <div class="mb-3">
      <label for="metaDescription" class="form-label">{{
        "common.seoDescription" | translate
      }}</label>
      <textarea
        class="form-control"
        id="metaDescription"
        formControlName="metaDescription"
        rows="3"
        maxlength="200"
        [class.is-invalid]="isFieldInvalid('metaDescription')"
      >
      </textarea>
      <div class="form-text">
        {{ "validation.maxCharacters" | translate: [200] }}
      </div>
      <app-validation-error
        [control]="form.get('metaDescription')"
        [fieldName]="'common.seoDescription' | translate"
      >
      </app-validation-error>
    </div>

    <div class="mb-3">
      <label for="metaKeywords" class="form-label">{{
        "common.seoKeywords" | translate
      }}</label>
      <input
        type="text"
        class="form-control"
        id="metaKeywords"
        formControlName="metaKeywords"
        maxlength="200"
        [class.is-invalid]="isFieldInvalid('metaKeywords')"
      />
      <div class="form-text">{{ "category.metaKeywordsHint" | translate }}</div>
      <app-validation-error
        [control]="form.get('metaKeywords')"
        [fieldName]="'common.seoKeywords' | translate"
      >
      </app-validation-error>
    </div>
  </div>

  <div class="d-flex justify-content-end gap-2 mt-4">
    <button type="button" class="btn btn-secondary" (click)="onCancel.emit()">
      {{ "common.cancel" | translate }}
    </button>
    <button
      type="submit"
      class="btn btn-primary"
      [disabled]="form.invalid || isSubmitting"
    >
      @if (isSubmitting) {
        <span class="spinner-border spinner-border-sm me-1"></span>
      }
      {{
        isEditing ? ("label.update" | translate) : ("label.create" | translate)
      }}
    </button>
  </div>
</form>
